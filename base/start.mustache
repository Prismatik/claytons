require('dotenv-safe').load({ sample: './example.env' });
require('app-module-path').addPath(__dirname);

const log = require('./lib/logger');
const setup = require('./setup');

setup()
.then(() => {
  const app = require('./src/app').server;
  const server = app.listen(process.env.PORT, () => {
    const host = server.address().address;
    const port = server.address().port;

    log.info('{{camelCase}} API listening at http://%s:%s', host, port);
  });
})
.catch(e => {
  log.error('Setup error:', e);
  process.exit(1);
});
